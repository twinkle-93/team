<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.member">
	<insert id="insert">
		insert into member
		(m_id, m_pw, m_name, m_birth,
		m_email, m_zipCode, m_address, m_detailAddress,
		m_phone, m_gender)
		values
		(#{m_id}, #{m_pw}, #{m_name}, #{m_birth}, #{m_email}, #{m_zipCode},
		#{m_address}, #{m_detailAddress}, #{m_phone}, #{m_gender})
	</insert>

	<select id="list" resultType="MemberDTO">
		select * from member
	</select>

	<select id="read" resultType="MemberDTO">
		select * from member where m_id =
		#{m_id}
	</select>

	<update id="update">
		update member set
		m_id = #{m_id},
		m_pw = #{m_pw},
		m_name = #{m_name},
		m_birth = #{m_birth},
		m_email = #{m_email},
		m_zipCode = #{m_zipCode},
		m_address = #{m_address},
		m_detailAddress = #{m_detailAddress},
		m_phone = #{m_phone},
		m_updateDate = SYSDATE
		where m_id = #{m_id}
	</update>
	
	<delete id="delete">
		delete from member where m_id = #{m_id}
	</delete>
	
	<select id="login" resultType="MemberDTO">
		select * from member where m_id = #{m_id} and m_pw = #{m_pw}
	</select>
	
	
	<select id="getAmount" resultType="Integer">
		select count(m_id) from member
	</select>
	
	
	<select id="getAmount_search" resultType="Integer">
		select count(*) from member
		<include refid="search"></include>
	</select>
	
	
	<select id="listAll" resultType="MemberDTO">
		select * from member 
		<include refid="search"></include>
	</select>
	
	<select id="getCount" resultType="Integer">
		select count(*) from member
		<include refid="search"></include>
	</select>
	
	<sql id="search">
		<choose>
			<!-- 전체검색일 경우 -->
			<when test="search_option == 'all'">
				where m_name like '%'||#{keyword}||'%'
				or m_id like '%'||#{keyword}||'%'
				or m_phone like '%'||#{keyword}||'%'
			</when>
			
			<otherwise>
				where ${search_option} like '%'||#{keyword}||'%'
			</otherwise>
		</choose>
	</sql>
	
	<update id="pointUpdate">
	    update member set
	    m_point = #{m_point}
	    where m_id = #{m_id}
	</update>
	
	<update id="moneyUpdate">
	    update member set
	    m_money = #{m_money}
	    where m_id = #{m_id}
	</update>
	
	<select id="pointRead" resultType="Integer">
	    select m_point from member where m_id = #{m_id}
	</select>
	
	<select id="moneyRead" resultType="Integer">
	    select m_money from member where m_id = #{m_id}
	</select>
	
	<select id="couponRead" resultType="Integer">
	    select m_coupon from member where m_id = #{m_id}
	</select>
	
	
	
	
	
	
	
</mapper>